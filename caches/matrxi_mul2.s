# Multiplies two matrixes X and Y and stores the result to matrix Z
# Matrixes are stored in row-major order in memory with 32x32 dimensions

.text
.globl _start
.set noat
.set noreorder
.ent _start

_start:

addi $s0, $zero, 0           # Row counter for matrix Z (index i).
addi $s1, $zero, 0	         # Column counter for matrix Z (index k)
addi $s2, $zero, 0	         # Inner loop counter for multiplication (index j).
addi $s3, $zero, 4096        # Total size in bytes of a 32x32 matrix (not used anywhere though)
addi $s4, $zero, 32          # Dimension of the matrix, n = 32
	
la $t6, array_x 			
la $t7, array_y
la $t5, array_z

Loop:                                 # Calculates matrix Z
	beq $s0, $s4, out
	
	outer:
		beq $s1, $s4, out2            # Calculates Z[i][k], i stays fixed and k goes from 0 to n-1
		
		inner:                        # This performs the additions X[i][j] * Y[j][k], i and k stay fixed and j goes from 0 to n-1
			beq $s2, $s4, out3
			
				lw $t0, 0 ($t6)       # Value from X[i][j].
				lw $t1, 0 ($t7)       # Value from Y[j][k].
				mul $t3, $t0, $t1     # Result of X[i][j] * Y[j][k].
				add $t2, $t2, $t3     # Accumulator for the sum X[i][j] * Y[j][k].
				
				addi $t6, $t6, 4      # Sets t6 as X[i][j+1]
				addi $t7, $t7, 128    # Sets t7 as Y[j+1][k] (assuming each line has 32 words)
				addi $s2, $s2, 1      # Sets j to j+1
			
			j inner  
		out3:  
	
		    sw $t2, 0 ($t5)           # This stores Z[i][k] to memory
		    addi $t5, $t5, 4          # Sets t5 to Z[i][k+1]
		    addi $t2, $zero, 0        # Sets t2 to zero (to prepare for next loop)
		    
			addi $t6, $t6, -128       # t6 was currently at X[i][n] and we restore it to X[i][0]
			addi $t7, $t7, -4092      # t7 was currently at Y[n][k] and we get it to Y[0][k+1]
			addi $s1, $s1, 1          # Sets k to k + 1
			addi $s2, $zero, 0        # Sets j to 0
	    
	    j outer                       # Goes back to calculate Z[i][k+1]

	out2:
	addi $t6, $t6, 128     # Gets X[i][0] to X[i+1][0]
	addi $s1, $zero, 0     # Sets s1 (which stores value of k) to zero
    addi $s0, $s0, 1       # Sets i to i + 1
    
    j Loop
    nop
    
out: 
	li $v0, 10                   # Σύστημα κλήσης για τερματισμό
    syscall
    
.end _start

.data
.org 10000000

array_x:    
.word -708, -23, 805, -870, -469, -224, -368, -366, -864, -267, 280, 574, -998, 14, -514, -693, -885, 777, 276, 56, -363, -120, -354, -573, -700, -898, 280, 616, -205, -623, -587, -442
.word 491, 476, 18, 86, 330, 568, -753, 713, -476, 229, 17, 250, 542, -101, -663, -909, -282, 210, -290, 312, 374, -54, 985, 739, -218, -646, -419, 258, -572, 339, -609, 390
.word -368, -825, -263, 391, 785, 659, 738, 254, -751, -619, 812, -856, 50, -952, 265, 450, 919, -25, -74, -533, -631, 950, 537, 426, -567, 456, 237, -253, -940, 424, 939, -307
.word -344, 606, -397, 291, -516, 728, -667, 56, -345, 953, 295, -100, 772, 24, -929, -654, 715, 88, -930, 119, -374, -201, 936, -30, -20, 211, -192, 121, 517, 571, -23, -112
.word -1, 379, 16, -747, 633, 758, 219, 73, -435, -991, 860, 617, -885, -820, 973, 882, -841, 832, 429, 568, -842, 264, 669, 22, -630, 400, 423, 571, -905, 122, 29, -302
.word 133, 438, -308, 791, 5, 682, -784, -546, 889, -882, 888, 337, -604, 898, -827, -438, -8, -948, -742, -937, -784, -804, -876, -232, 24, -921, 547, -712, -336, 44, 969, -474
.word -211, -190, -438, 275, -312, -378, -140, -8, 434, 12, -120, 44, 138, 824, 408, -861, 507, -34, -865, -425, 540, -415, -194, 5, -138, -590, -237, -666, -228, 13, -22, -699
.word -153, -624, -887, -910, 668, -444, -580, -108, -520, 407, 506, -631, -215, 976, -655, 218, 382, -422, -968, 667, 311, -64, -598, -561, -183, -476, 825, 215, -50, -887, -816, 917
.word -15, 592, 650, -265, -101, 635, 792, -855, -307, -652, 51, 763, -775, -276, 806, -328, 89, -327, -954, -804, -569, -242, -502, -577, -60, 235, -156, -808, -443, 10, 530, -964
.word -152, 924, -33, -601, -585, -619, 944, -75, -345, -924, 100, 567, -311, -276, -534, 304, 278, -377, -657, 237, 406, 33, -436, -715, 814, 437, 868, 198, -864, 843, 490, -414
.word -374, 812, -898, -943, -292, -815, -86, 212, -291, 916, -267, -527, -258, 295, -970, -433, -399, 864, 686, 74, 540, 125, -80, 498, 844, -827, -451, -224, 861, 829, 297, -207
.word -630, -107, -491, -371, -237, 80, 566, 266, -103, -342, -68, -431, 658, 904, -496, 527, -20, -515, 149, 122, 393, -197, -190, -5, 906, 238, -185, 821, -820, 985, 870, -721
.word -751, -619, -67, 607, -314, 64, 388, 763, 495, 873, 869, 95, 193, -243, -609, -663, 798, -634, -882, 551, 968, 407, -103, 811, 657, 418, 949, 78, 736, -344, 148, 751
.word -957, 431, 932, 609, 943, -825, 900, -198, -657, 748, -942, 666, 5, 586, 540, 586, -26, -718, -629, 740, 77, 561, 760, 382, 962, -674, 387, -394, 230, -982, 38, -539
.word -821, 194, 481, 628, -984, -923, 144, 674, -819, 64, -827, -409, -26, -321, 267, -161, -355, -585, 999, -6, -77, 481, 607, -830, 705, -845, 197, -808, -651, -569, 32, -54
.word -737, 742, -31, -74, -783, -63, 363, -489, 1, -452, 675, 708, 131, 95, 512, 192, 41, 113, 422, 514, 974, -757, 888, 400, -318, -532, 921, -940, -92, -750, 835, 379
.word 280, -951, 709, 376, -947, 654, -762, -419, -190, -98, -8, -942, -490, -908, -249, -780, -461, 411, -208, -18, -504, 811, 757, 497, -796, -911, 720, 405, -308, 888, -396, -25
.word 869, 194, 130, -835, 219, 191, 893, -894, -858, -622, -544, 41, 741, -867, -356, 63, -841, -390, 926, 675, -540, -754, -867, -586, 126, 323, -722, 12, -725, 924, -371, -679
.word -714, -520, -199, -94, 514, -662, 495, -88, -872, -17, -497, -106, -295, 729, 892, 433, 14, 120, 434, 530, -866, 142, -909, -888, -506, -691, -422, -5, 733, 39, 146, 545
.word 456, 389, 883, -638, 44, -397, -608, 882, 917, 384, 709, 910, -388, -242, 945, -808, 658, -542, -805, -610, -286, 471, 394, -884, -966, -163, -892, 134, -995, -907, -476, -717
.word 144, 622, 882, -16, -379, -613, -272, 97, 812, -744, -433, -356, -701, -809, 755, -291, -715, -463, -219, 267, -490, 553, 976, 252, 553, 556, 561, 494, 139, -768, -134, -328
.word 862, -512, 911, -313, -624, -262, 449, 452, -389, 669, -568, -872, 270, -152, 759, -164, -69, 712, 605, 41, 511, -237, -64, -286, -960, 892, -890, -716, 877, -545, -486, 434
.word 688, -831, -936, 607, 810, -547, -820, -718, 926, 630, 460, -486, -405, 963, 941, -133, 301, 856, -838, 329, 497, -38, -812, -559, 934, -48, -179, -417, 171, -81, -789, -393
.word -965, 438, -847, 835, 272, 964, -493, -624, 216, 967, 584, -286, 265, -544, -841, -838, 727, -692, 876, 858, 635, -74, -228, 560, -753, -117, -93, 782, -834, -16, -680, -700
.word 485, -51, 316, -542, 619, 864, -424, -609, -184, -615, -824, -605, -211, -63, -927, 193, 726, 899, 597, 91, -364, -348, 106, 837, 287, -923, -18, -849, -634, 720, 998, -825
.word -824, 826, 856, -261, 15, -75, 407, -15, 604, -862, -1, 436, -636, -192, -403, 657, -140, 481, -593, 109, -344, -157, -573, 171, -530, 123, 647, 142, -800, -675, 651, -309
.word -663, -129, 418, 460, -873, -63, 411, -955, 317, 437, -904, -784, 468, 6, -745, 334, -85, -922, 237, 181, 381, -823, 455, 161, -319, 856, -310, 827, 464, -658, -869, -457
.word -147, 560, 452, -518, -367, 43, -796, -851, -988, 254, -407, 430, 66, 910, -980, -529, 558, 98, 419, -299, 355, -514, 796, 486, 125, -938, -983, -580, 671, -62, 614, -243
.word -388, 485, 853, -26, 384, -122, -635, 69, 743, 137, -433, -696, 238, 67, 283, 397, 372, 98, 705, -387, 843, 949, -514, -907, -121, -120, 735, -991, -365, -397, 450, 694
.word -348, -550, -421, 660, 389, 224, 949, 271, -512, 319, -904, 138, 341, 355, 367, -760, 446, 349, -865, -382, 134, 197, -616, -415, 853, -542, 240, -826, -939, -314, 225, 929
.word -352, -353, 539, -914, 740, 246, -130, -303, 395, -918, 60, 392, 69, 830, 636, -879, 381, -810, -220, 225, -398, -963, 282, 86, 695, 232, -473, -768, 711, 731, 639, -916
.word -129, 568, 896, 694, -417, -498, -807, 557, -229, -354, 541, 762, 315, -658, -780, -830, -108, 987, -33, 361, 840, -614, -297, -745, -521, -268, -958, -379, 702, -537, -228, 952


array_y:    
.word -708, -23, 805, -870, -469, -224, -368, -366, -864, -267, 280, 574, -998, 14, -514, -693, -885, 777, 276, 56, -363, -120, -354, -573, -700, -898, 280, 616, -205, -623, -587, -442
.word 491, 476, 18, 86, 330, 568, -753, 713, -476, 229, 17, 250, 542, -101, -663, -909, -282, 210, -290, 312, 374, -54, 985, 739, -218, -646, -419, 258, -572, 339, -609, 390
.word -368, -825, -263, 391, 785, 659, 738, 254, -751, -619, 812, -856, 50, -952, 265, 450, 919, -25, -74, -533, -631, 950, 537, 426, -567, 456, 237, -253, -940, 424, 939, -307
.word -344, 606, -397, 291, -516, 728, -667, 56, -345, 953, 295, -100, 772, 24, -929, -654, 715, 88, -930, 119, -374, -201, 936, -30, -20, 211, -192, 121, 517, 571, -23, -112
.word -1, 379, 16, -747, 633, 758, 219, 73, -435, -991, 860, 617, -885, -820, 973, 882, -841, 832, 429, 568, -842, 264, 669, 22, -630, 400, 423, 571, -905, 122, 29, -302
.word 133, 438, -308, 791, 5, 682, -784, -546, 889, -882, 888, 337, -604, 898, -827, -438, -8, -948, -742, -937, -784, -804, -876, -232, 24, -921, 547, -712, -336, 44, 969, -474
.word -211, -190, -438, 275, -312, -378, -140, -8, 434, 12, -120, 44, 138, 824, 408, -861, 507, -34, -865, -425, 540, -415, -194, 5, -138, -590, -237, -666, -228, 13, -22, -699
.word -153, -624, -887, -910, 668, -444, -580, -108, -520, 407, 506, -631, -215, 976, -655, 218, 382, -422, -968, 667, 311, -64, -598, -561, -183, -476, 825, 215, -50, -887, -816, 917
.word -15, 592, 650, -265, -101, 635, 792, -855, -307, -652, 51, 763, -775, -276, 806, -328, 89, -327, -954, -804, -569, -242, -502, -577, -60, 235, -156, -808, -443, 10, 530, -964
.word -152, 924, -33, -601, -585, -619, 944, -75, -345, -924, 100, 567, -311, -276, -534, 304, 278, -377, -657, 237, 406, 33, -436, -715, 814, 437, 868, 198, -864, 843, 490, -414
.word -374, 812, -898, -943, -292, -815, -86, 212, -291, 916, -267, -527, -258, 295, -970, -433, -399, 864, 686, 74, 540, 125, -80, 498, 844, -827, -451, -224, 861, 829, 297, -207
.word -630, -107, -491, -371, -237, 80, 566, 266, -103, -342, -68, -431, 658, 904, -496, 527, -20, -515, 149, 122, 393, -197, -190, -5, 906, 238, -185, 821, -820, 985, 870, -721
.word -751, -619, -67, 607, -314, 64, 388, 763, 495, 873, 869, 95, 193, -243, -609, -663, 798, -634, -882, 551, 968, 407, -103, 811, 657, 418, 949, 78, 736, -344, 148, 751
.word -957, 431, 932, 609, 943, -825, 900, -198, -657, 748, -942, 666, 5, 586, 540, 586, -26, -718, -629, 740, 77, 561, 760, 382, 962, -674, 387, -394, 230, -982, 38, -539
.word -821, 194, 481, 628, -984, -923, 144, 674, -819, 64, -827, -409, -26, -321, 267, -161, -355, -585, 999, -6, -77, 481, 607, -830, 705, -845, 197, -808, -651, -569, 32, -54
.word -737, 742, -31, -74, -783, -63, 363, -489, 1, -452, 675, 708, 131, 95, 512, 192, 41, 113, 422, 514, 974, -757, 888, 400, -318, -532, 921, -940, -92, -750, 835, 379
.word 280, -951, 709, 376, -947, 654, -762, -419, -190, -98, -8, -942, -490, -908, -249, -780, -461, 411, -208, -18, -504, 811, 757, 497, -796, -911, 720, 405, -308, 888, -396, -25
.word 869, 194, 130, -835, 219, 191, 893, -894, -858, -622, -544, 41, 741, -867, -356, 63, -841, -390, 926, 675, -540, -754, -867, -586, 126, 323, -722, 12, -725, 924, -371, -679
.word -714, -520, -199, -94, 514, -662, 495, -88, -872, -17, -497, -106, -295, 729, 892, 433, 14, 120, 434, 530, -866, 142, -909, -888, -506, -691, -422, -5, 733, 39, 146, 545
.word 456, 389, 883, -638, 44, -397, -608, 882, 917, 384, 709, 910, -388, -242, 945, -808, 658, -542, -805, -610, -286, 471, 394, -884, -966, -163, -892, 134, -995, -907, -476, -717
.word 144, 622, 882, -16, -379, -613, -272, 97, 812, -744, -433, -356, -701, -809, 755, -291, -715, -463, -219, 267, -490, 553, 976, 252, 553, 556, 561, 494, 139, -768, -134, -328
.word 862, -512, 911, -313, -624, -262, 449, 452, -389, 669, -568, -872, 270, -152, 759, -164, -69, 712, 605, 41, 511, -237, -64, -286, -960, 892, -890, -716, 877, -545, -486, 434
.word 688, -831, -936, 607, 810, -547, -820, -718, 926, 630, 460, -486, -405, 963, 941, -133, 301, 856, -838, 329, 497, -38, -812, -559, 934, -48, -179, -417, 171, -81, -789, -393
.word -965, 438, -847, 835, 272, 964, -493, -624, 216, 967, 584, -286, 265, -544, -841, -838, 727, -692, 876, 858, 635, -74, -228, 560, -753, -117, -93, 782, -834, -16, -680, -700
.word 485, -51, 316, -542, 619, 864, -424, -609, -184, -615, -824, -605, -211, -63, -927, 193, 726, 899, 597, 91, -364, -348, 106, 837, 287, -923, -18, -849, -634, 720, 998, -825
.word -824, 826, 856, -261, 15, -75, 407, -15, 604, -862, -1, 436, -636, -192, -403, 657, -140, 481, -593, 109, -344, -157, -573, 171, -530, 123, 647, 142, -800, -675, 651, -309
.word -663, -129, 418, 460, -873, -63, 411, -955, 317, 437, -904, -784, 468, 6, -745, 334, -85, -922, 237, 181, 381, -823, 455, 161, -319, 856, -310, 827, 464, -658, -869, -457
.word -147, 560, 452, -518, -367, 43, -796, -851, -988, 254, -407, 430, 66, 910, -980, -529, 558, 98, 419, -299, 355, -514, 796, 486, 125, -938, -983, -580, 671, -62, 614, -243
.word -388, 485, 853, -26, 384, -122, -635, 69, 743, 137, -433, -696, 238, 67, 283, 397, 372, 98, 705, -387, 843, 949, -514, -907, -121, -120, 735, -991, -365, -397, 450, 694
.word -348, -550, -421, 660, 389, 224, 949, 271, -512, 319, -904, 138, 341, 355, 367, -760, 446, 349, -865, -382, 134, 197, -616, -415, 853, -542, 240, -826, -939, -314, 225, 929
.word -352, -353, 539, -914, 740, 246, -130, -303, 395, -918, 60, 392, 69, 830, 636, -879, 381, -810, -220, 225, -398, -963, 282, 86, 695, 232, -473, -768, 711, 731, 639, -916
.word -129, 568, 896, 694, -417, -498, -807, 557, -229, -354, 541, 762, 315, -658, -780, -830, -108, 987, -33, 361, 840, -614, -297, -745, -521, -268, -958, -379, 702, -537, -228, 952


array_z:    .space  4096

